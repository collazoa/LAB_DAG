report <- expand_grid(prob_A, mean_L, sd_L, b_0, b_1, b_2, g_0, g_1, g_2, sd_Y, sd_W, cutoff_W, n)
n_exp<-50
dat<-data.frame()
coef_biased<-NA
baseline_adj_coef<-NA
estimate_biased<-NA
estimate_unbiased<-NA
set.seed(100)
exploratory_data <- list()
for(b in 1: n_exp) {
for ( i in 1:nrow(report)) {
dat <- data.frame(A = rep(0:1,report$prob_A[i]*report$n[i], each=1),
L = rnorm(n=report$n[i], mean=report$mean_L[i], sd=report$sd_L[i]))
dat$W <- report$g_0[i] + report$g_1[i]*dat$A + report$g_2[i]*dat$L + rnorm(report$n[i], 0, report$sd_W[i])
dat$Y <- report$b_0[i] + report$b_1[i]*dat$A + report$b_2[i]*dat$L + rnorm(report$n[i], 0, report$sd_Y[i])
dat$W2 <- dat$W >= quantile(dat$W, probs=report$cutoff_W[i])
dat$A <- as.factor(dat$A)
dat_s <- dat %>% filter(W2==TRUE)
#estimate in the censored data-set
estimate_biased[i] <-  mean(dat_s$Y[dat_s$A==1]) - mean(dat_s$Y[dat_s$A==0])
estimate_unbiased[i]<- mean(dat$Y[dat$A ==1]- mean(dat$Y[dat$A == 0]))
#perform a linear regression in the censored dataset
#without correcting for baselin stroke volume
model1<-lm(dat_s$Y ~ dat_s$A, data = dat_s)
coef_biased[i]<-model1$coefficients[2]
#while correcting for baseline stroke volume (dat$L)
model2<-lm(dat_s$Y ~ dat_s$A + dat_s$L, data = dat_s)
baseline_adj_coef[i] <-model2$coefficients[2]
report$coef_biased[i] <-coef_biased[i]
report$baseline_adj_coef[i]<-baseline_adj_coef[i]
report$estimate_biased[i] <-estimate_biased[i]
report$estimate_unbiased[i]<-estimate_unbiased[i]
}
exploratory_data[[b]]<-report
}
View(exploratory_data)
prob_A = 0.5
mean_L = 190  # from O'Collins (Book Chapter) Table 20.6. infarct size in control cohorts -> However time point is not clear, should we rather use
# values from Gerriet 2003 (Figure 4)?
sd_L = 50
b_0 = 50
b_1 = 0 # this values will be varied to simulate a causal treatment effect
b_2 = c(1.2) # this values were set according after combining estimates from Gerriet 2003 and O'Collins (Book Chapter):
# baseline stroke volume is 6h after MCAo, outcome measurement is 24h after MCAo
g_0 = 3
g_1 = c(-10) #this values will be varied to simulate a treatment effect on welfare with different magnitudes
g_2 = c(-5.5) #taken from Bederson et al. 1986
sd_Y = 25
sd_W = 2
cutoff_W = c(0.3)
n = 200
report <- expand_grid(prob_A, mean_L, sd_L, b_0, b_1, b_2, g_0, g_1, g_2, sd_Y, sd_W, cutoff_W, n)
n_exp<-50
dat<-data.frame()
coef_biased<-NA
baseline_adj_coef<-NA
estimate_biased<-NA
estimate_unbiased<-NA
set.seed(100)
exploratory_data <- list()
for(b in 1: n_exp) {
for ( i in 1:nrow(report)) {
dat <- data.frame(A = rep(0:1,report$prob_A[i]*report$n[i], each=1),
L = rnorm(n=report$n[i], mean=report$mean_L[i], sd=report$sd_L[i]))
dat$W <- report$g_0[i] + report$g_1[i]*dat$A + report$g_2[i]*dat$L + rnorm(report$n[i], 0, report$sd_W[i])
dat$Y <- report$b_0[i] + report$b_1[i]*dat$A + report$b_2[i]*dat$L + rnorm(report$n[i], 0, report$sd_Y[i])
dat$W2 <- dat$W >= quantile(dat$W, probs=report$cutoff_W[i])
dat$A <- as.factor(dat$A)
dat_s <- dat %>% filter(W2==TRUE)
#estimate in the censored data-set
estimate_biased[i] <-  mean(dat_s$Y[dat_s$A==1]) - mean(dat_s$Y[dat_s$A==0])
estimate_unbiased[i]<- mean(dat$Y[dat$A ==1]- mean(dat$Y[dat$A == 0]))
#perform a linear regression in the censored dataset
#without correcting for baselin stroke volume
model1<-lm(dat_s$Y ~ dat_s$A, data = dat_s)
coef_biased[i]<-model1$coefficients[2]
#while correcting for baseline stroke volume (dat$L)
model2<-lm(dat_s$Y ~ dat_s$A + dat_s$L, data = dat_s)
baseline_adj_coef[i] <-model2$coefficients[2]
report$coef_biased[i] <-coef_biased[i]
report$baseline_adj_coef[i]<-baseline_adj_coef[i]
report$estimate_biased[i] <-estimate_biased[i]
report$estimate_unbiased[i]<-estimate_unbiased[i]
}
exploratory_data[[b]]<-report
}
View(exploratory_data)
get_estimate<-function(variable_name){
variable_name<-list()
for (i in 1:length(exploratory_data)) {
coverage[[i]]<-exploratory_data[[i]]$variable_name[1]
}
}
get_estimate<-function(variable_name) {
variable_name<-list()
for (i in 1:length(exploratory_data)) {
coverage[[i]]<-exploratory_data[[i]]$variable_name[1]
}
}
get_estimate<- function (variable_name) {
variable_name<-list()
for (i in 1:length(exploratory_data)) {
coverage[[i]]<-exploratory_data[[i]]$variable_name[1]
}
}
get_summary_study <- function(study_data) {
nonpar_BF<-rank.two.samples(study_data$values~study_data$treatment , data =study_data , method = "t.app",
shift.int = FALSE ) # Brunner-Munzel non-parametric test
nonpar_BF<-nonpar_BF$Analysis
L_CI <-nonpar_BF$Lower # extracting lower confidence interval
U_CI <-nonpar_BF$Upper # extracting upper confidence interval
rel_p<-nonpar_BF$Estimator # extracting estimator for the relative effect
study_summary <-
study_data %>%
mutate(rel_p = round(rel_p, 3),
L_CI = round(L_CI, 3),
U_CI = round(U_CI, 3),
success = ifelse(L_CI<= p & U_CI >= p, TRUE, FALSE)) # checking whether the confidence interval covers
# the estimate underlying effect from the first simulation ( p = 0.396)
}
warnings()
get_estimate<- function (variable_name) {
variable_name<-list()
for (i in 1:length(exploratory_data)) {
variable_name[[i]]<-exploratory_data[[i]]$variable_name[1]
}
}
View(get_estimate)
coef_biased<-list()
get_estimate<- function (variable_name) {
for (i in 1:length(exploratory_data)) {
variable_name[[i]]<-exploratory_data[[i]]$variable_name[1]
}
}
coef_biased<-list()
get_estimate(coef_biased)
vec_coef_biased<-as.vector(unlist(coef_biased))
get_estimate<- function(data) {
for (i in 1:length(exploratory_data)) {
data[[i]]<-exploratory_data[[i]]$data[1]
}
}
for (i in 1:length(exploratory_data)) {
coef_biased[[i]]<-exploratory_data[[i]]$data[1]}
for (i in 1:length(exploratory_data)) {
coef_biased[[i]]<-exploratory_data[[i]]$coef_biased[1]}
View(coef_biased)
View(exploratory_data)
baseline_adj_coef<-list()
for (i in 1:length(exploratory_data)) {
baseline_adj_coef[[i]]<-exploratory_data[[i]]$baseline_adj_coef[1]}
vec_baseline_adj_coef<-as.vector(unlist(baseline_adj_coef))
vec_coef_biased<-as.vector(unlist(coef_biased))
estimate_biased<-list()
for (i in 1:length(exploratory_data)) {
estimate_biased[[i]]<-exploratory_data[[i]]$estimate_biased[1]}
vec_estimate_biased<-as.vector(unlist(estimate_biased))
estimate_unbiased<-list()
for (i in 1:length(exploratory_data)) {
estimate_unbiased[[i]]<-exploratory_data[[i]]$estimate_unbiased[1]}
vec_estimate_unbiased<-as.vector(unlist(estimate_unbiased))
summary_estimates<-data.frame(baseline_adj_coef = vec_baseline_adj_coef,
coef_biased = vec_coef_biased,
estimate_biased = vec_estimate_biased,
estimate_unbiased = vec_estimate_unbiased)
View(summary_estimates)
estimates<-data.frame(baseline_adj_coef = vec_baseline_adj_coef,
coef_biased = vec_coef_biased,
estimate_biased = vec_estimate_biased,
estimate_unbiased = vec_estimate_unbiased)
summary_estimates<-data.frame(diff_adj_unbiased = estimate_unbiased - baseline_adj_coef,
diff_unadj_unbiased = estimate_unbiased - coef_biased)
summary_estimates<-data.frame(diff_adj_unbiased = estimate$estimate_unbiased - estimates$baseline_adj_coef,
diff_unadj_unbiased = estimates$estimate_unbiased - estimates$coef_biased)
summary_estimates<-data.frame(diff_adj_unbiased = estimates$estimate_unbiased - estimates$baseline_adj_coef,
diff_unadj_unbiased = estimates$estimate_unbiased - estimates$coef_biased)
View(summary_estimates)
mean_estimates<-data.frame(mean_diff_adj_unbiased = mean(summary_estimates$diff_adj_unbiased),
mean_diff_unadj_unbiased = mean(summary_estimates$diff_unadj_unbiased))
View(mean_estimates)
prob_A = 0.5
mean_L = 190  # from O'Collins (Book Chapter) Table 20.6. infarct size in control cohorts -> However time point is not clear, should we rather use
# values from Gerriet 2003 (Figure 4)?
sd_L = 50
b_0 = 50
b_1 = 0 # this values will be varied to simulate a causal treatment effect
b_2 = c(1.2) # this values were set according after combining estimates from Gerriet 2003 and O'Collins (Book Chapter):
# baseline stroke volume is 6h after MCAo, outcome measurement is 24h after MCAo
g_0 = 3
g_1 = c(-10) #this values will be varied to simulate a treatment effect on welfare with different magnitudes
g_2 = c(-5.5) #taken from Bederson et al. 1986
sd_Y = 25
sd_W = 2
cutoff_W = c(0.3)
n = 10
report <- expand_grid(prob_A, mean_L, sd_L, b_0, b_1, b_2, g_0, g_1, g_2, sd_Y, sd_W, cutoff_W, n)
n_exp<-1000
dat<-data.frame()
coef_biased<-NA
baseline_adj_coef<-NA
estimate_biased<-NA
estimate_unbiased<-NA
set.seed(100)
exploratory_data <- list()
for(b in 1: n_exp) {
for ( i in 1:nrow(report)) {
dat <- data.frame(A = rep(0:1,report$prob_A[i]*report$n[i], each=1),
L = rnorm(n=report$n[i], mean=report$mean_L[i], sd=report$sd_L[i]))
dat$W <- report$g_0[i] + report$g_1[i]*dat$A + report$g_2[i]*dat$L + rnorm(report$n[i], 0, report$sd_W[i])
dat$Y <- report$b_0[i] + report$b_1[i]*dat$A + report$b_2[i]*dat$L + rnorm(report$n[i], 0, report$sd_Y[i])
dat$W2 <- dat$W >= quantile(dat$W, probs=report$cutoff_W[i])
dat$A <- as.factor(dat$A)
dat_s <- dat %>% filter(W2==TRUE)
#estimate in the censored data-set
estimate_biased[i] <-  mean(dat_s$Y[dat_s$A==1]) - mean(dat_s$Y[dat_s$A==0])
estimate_unbiased[i]<- mean(dat$Y[dat$A ==1]- mean(dat$Y[dat$A == 0]))
#perform a linear regression in the censored dataset
#without correcting for baselin stroke volume
model1<-lm(dat_s$Y ~ dat_s$A, data = dat_s)
coef_biased[i]<-model1$coefficients[2]
#while correcting for baseline stroke volume (dat$L)
model2<-lm(dat_s$Y ~ dat_s$A + dat_s$L, data = dat_s)
baseline_adj_coef[i] <-model2$coefficients[2]
report$coef_biased[i] <-coef_biased[i]
report$baseline_adj_coef[i]<-baseline_adj_coef[i]
report$estimate_biased[i] <-estimate_biased[i]
report$estimate_unbiased[i]<-estimate_unbiased[i]
}
exploratory_data[[b]]<-report
}
coef_biased<-list()
for (i in 1:length(exploratory_data)) {
coef_biased[[i]]<-exploratory_data[[i]]$coef_biased[1]}
vec_coef_biased<-as.vector(unlist(coef_biased))
baseline_adj_coef<-list()
for (i in 1:length(exploratory_data)) {
baseline_adj_coef[[i]]<-exploratory_data[[i]]$baseline_adj_coef[1]}
vec_baseline_adj_coef<-as.vector(unlist(baseline_adj_coef))
estimate_biased<-list()
for (i in 1:length(exploratory_data)) {
estimate_biased[[i]]<-exploratory_data[[i]]$estimate_biased[1]}
vec_estimate_biased<-as.vector(unlist(estimate_biased))
estimate_unbiased<-list()
for (i in 1:length(exploratory_data)) {
estimate_unbiased[[i]]<-exploratory_data[[i]]$estimate_unbiased[1]}
vec_estimate_unbiased<-as.vector(unlist(estimate_unbiased))
estimates<-data.frame(baseline_adj_coef = vec_baseline_adj_coef,
coef_biased = vec_coef_biased,
estimate_biased = vec_estimate_biased,
estimate_unbiased = vec_estimate_unbiased)
summary_estimates<-data.frame(diff_adj_unbiased = estimates$estimate_unbiased - estimates$baseline_adj_coef,
diff_unadj_unbiased = estimates$estimate_unbiased - estimates$coef_biased)
mean_estimates<-data.frame(mean_diff_adj_unbiased = mean(summary_estimates$diff_adj_unbiased),
mean_diff_unadj_unbiased = mean(summary_estimates$diff_unadj_unbiased))
View(mean_estimates)
View(mean_estimates)
prob_A = 0.5
mean_L = 190  # from O'Collins (Book Chapter) Table 20.6. infarct size in control cohorts -> However time point is not clear, should we rather use
# values from Gerriet 2003 (Figure 4)?
sd_L = 50
b_0 = 50
b_1 = 0 # this values will be varied to simulate a causal treatment effect
b_2 = c(1.2) # this values were set according after combining estimates from Gerriet 2003 and O'Collins (Book Chapter):
# baseline stroke volume is 6h after MCAo, outcome measurement is 24h after MCAo
g_0 = 3
g_1 = c(-10) #this values will be varied to simulate a treatment effect on welfare with different magnitudes
g_2 = c(-5.5) #taken from Bederson et al. 1986
sd_Y = 25
sd_W = 2
cutoff_W = c(0.3)
n = 100
report <- expand_grid(prob_A, mean_L, sd_L, b_0, b_1, b_2, g_0, g_1, g_2, sd_Y, sd_W, cutoff_W, n)
n_exp<-1000
dat<-data.frame()
coef_biased<-NA
baseline_adj_coef<-NA
estimate_biased<-NA
estimate_unbiased<-NA
set.seed(100)
exploratory_data <- list()
for(b in 1: n_exp) {
for ( i in 1:nrow(report)) {
dat <- data.frame(A = rep(0:1,report$prob_A[i]*report$n[i], each=1),
L = rnorm(n=report$n[i], mean=report$mean_L[i], sd=report$sd_L[i]))
dat$W <- report$g_0[i] + report$g_1[i]*dat$A + report$g_2[i]*dat$L + rnorm(report$n[i], 0, report$sd_W[i])
dat$Y <- report$b_0[i] + report$b_1[i]*dat$A + report$b_2[i]*dat$L + rnorm(report$n[i], 0, report$sd_Y[i])
dat$W2 <- dat$W >= quantile(dat$W, probs=report$cutoff_W[i])
dat$A <- as.factor(dat$A)
dat_s <- dat %>% filter(W2==TRUE)
#estimate in the censored data-set
estimate_biased[i] <-  mean(dat_s$Y[dat_s$A==1]) - mean(dat_s$Y[dat_s$A==0])
estimate_unbiased[i]<- mean(dat$Y[dat$A ==1]- mean(dat$Y[dat$A == 0]))
#perform a linear regression in the censored dataset
#without correcting for baselin stroke volume
model1<-lm(dat_s$Y ~ dat_s$A, data = dat_s)
coef_biased[i]<-model1$coefficients[2]
#while correcting for baseline stroke volume (dat$L)
model2<-lm(dat_s$Y ~ dat_s$A + dat_s$L, data = dat_s)
baseline_adj_coef[i] <-model2$coefficients[2]
report$coef_biased[i] <-coef_biased[i]
report$baseline_adj_coef[i]<-baseline_adj_coef[i]
report$estimate_biased[i] <-estimate_biased[i]
report$estimate_unbiased[i]<-estimate_unbiased[i]
}
exploratory_data[[b]]<-report
}
coef_biased<-list()
for (i in 1:length(exploratory_data)) {
coef_biased[[i]]<-exploratory_data[[i]]$coef_biased[1]}
vec_coef_biased<-as.vector(unlist(coef_biased))
baseline_adj_coef<-list()
for (i in 1:length(exploratory_data)) {
baseline_adj_coef[[i]]<-exploratory_data[[i]]$baseline_adj_coef[1]}
vec_baseline_adj_coef<-as.vector(unlist(baseline_adj_coef))
estimate_biased<-list()
for (i in 1:length(exploratory_data)) {
estimate_biased[[i]]<-exploratory_data[[i]]$estimate_biased[1]}
vec_estimate_biased<-as.vector(unlist(estimate_biased))
estimate_unbiased<-list()
for (i in 1:length(exploratory_data)) {
estimate_unbiased[[i]]<-exploratory_data[[i]]$estimate_unbiased[1]}
vec_estimate_unbiased<-as.vector(unlist(estimate_unbiased))
estimates<-data.frame(baseline_adj_coef = vec_baseline_adj_coef,
coef_biased = vec_coef_biased,
estimate_biased = vec_estimate_biased,
estimate_unbiased = vec_estimate_unbiased)
summary_estimates<-data.frame(diff_adj_unbiased = estimates$estimate_unbiased - estimates$baseline_adj_coef,
diff_unadj_unbiased = estimates$estimate_unbiased - estimates$coef_biased)
mean_estimates<-data.frame(mean_diff_adj_unbiased = mean(summary_estimates$diff_adj_unbiased),
mean_diff_unadj_unbiased = mean(summary_estimates$diff_unadj_unbiased))
View(exploratory_data)
View(exploratory_data)
View(mean_estimates)
prob_A = 0.5
mean_L = 190  # from O'Collins (Book Chapter) Table 20.6. infarct size in control cohorts -> However time point is not clear, should we rather use
# values from Gerriet 2003 (Figure 4)?
sd_L = 50
b_0 = 50
b_1 = 0 # this values will be varied to simulate a causal treatment effect
b_2 = c(1.2) # this values were set according after combining estimates from Gerriet 2003 and O'Collins (Book Chapter):
# baseline stroke volume is 6h after MCAo, outcome measurement is 24h after MCAo
g_0 = 3
g_1 = c(-10) #this values will be varied to simulate a treatment effect on welfare with different magnitudes
g_2 = c(-5.5) #taken from Bederson et al. 1986
sd_Y = 25
sd_W = 2
cutoff_W = c(0.3)
n = 100
report <- expand_grid(prob_A, mean_L, sd_L, b_0, b_1, b_2, g_0, g_1, g_2, sd_Y, sd_W, cutoff_W, n)
n_exp<-10000
dat<-data.frame()
coef_biased<-NA
baseline_adj_coef<-NA
estimate_biased<-NA
estimate_unbiased<-NA
set.seed(100)
exploratory_data <- list()
for(b in 1: n_exp) {
for ( i in 1:nrow(report)) {
dat <- data.frame(A = rep(0:1,report$prob_A[i]*report$n[i], each=1),
L = rnorm(n=report$n[i], mean=report$mean_L[i], sd=report$sd_L[i]))
dat$W <- report$g_0[i] + report$g_1[i]*dat$A + report$g_2[i]*dat$L + rnorm(report$n[i], 0, report$sd_W[i])
dat$Y <- report$b_0[i] + report$b_1[i]*dat$A + report$b_2[i]*dat$L + rnorm(report$n[i], 0, report$sd_Y[i])
dat$W2 <- dat$W >= quantile(dat$W, probs=report$cutoff_W[i])
dat$A <- as.factor(dat$A)
dat_s <- dat %>% filter(W2==TRUE)
#estimate in the censored data-set
estimate_biased[i] <-  mean(dat_s$Y[dat_s$A==1]) - mean(dat_s$Y[dat_s$A==0])
estimate_unbiased[i]<- mean(dat$Y[dat$A ==1]- mean(dat$Y[dat$A == 0]))
#perform a linear regression in the censored dataset
#without correcting for baselin stroke volume
model1<-lm(dat_s$Y ~ dat_s$A, data = dat_s)
coef_biased[i]<-model1$coefficients[2]
#while correcting for baseline stroke volume (dat$L)
model2<-lm(dat_s$Y ~ dat_s$A + dat_s$L, data = dat_s)
baseline_adj_coef[i] <-model2$coefficients[2]
report$coef_biased[i] <-coef_biased[i]
report$baseline_adj_coef[i]<-baseline_adj_coef[i]
report$estimate_biased[i] <-estimate_biased[i]
report$estimate_unbiased[i]<-estimate_unbiased[i]
}
exploratory_data[[b]]<-report
}
coef_biased<-list()
for (i in 1:length(exploratory_data)) {
coef_biased[[i]]<-exploratory_data[[i]]$coef_biased[1]}
vec_coef_biased<-as.vector(unlist(coef_biased))
baseline_adj_coef<-list()
for (i in 1:length(exploratory_data)) {
baseline_adj_coef[[i]]<-exploratory_data[[i]]$baseline_adj_coef[1]}
vec_baseline_adj_coef<-as.vector(unlist(baseline_adj_coef))
estimate_biased<-list()
for (i in 1:length(exploratory_data)) {
estimate_biased[[i]]<-exploratory_data[[i]]$estimate_biased[1]}
vec_estimate_biased<-as.vector(unlist(estimate_biased))
estimate_unbiased<-list()
for (i in 1:length(exploratory_data)) {
estimate_unbiased[[i]]<-exploratory_data[[i]]$estimate_unbiased[1]}
vec_estimate_unbiased<-as.vector(unlist(estimate_unbiased))
estimates<-data.frame(baseline_adj_coef = vec_baseline_adj_coef,
coef_biased = vec_coef_biased,
estimate_biased = vec_estimate_biased,
estimate_unbiased = vec_estimate_unbiased)
summary_estimates<-data.frame(diff_adj_unbiased = estimates$estimate_unbiased - estimates$baseline_adj_coef,
diff_unadj_unbiased = estimates$estimate_unbiased - estimates$coef_biased)
mean_estimates<-data.frame(mean_diff_adj_unbiased = mean(summary_estimates$diff_adj_unbiased),
mean_diff_unadj_unbiased = mean(summary_estimates$diff_unadj_unbiased))
View(mean_estimates)
prob_A = 0.5
mean_L = 190  # from O'Collins (Book Chapter) Table 20.6. infarct size in control cohorts -> However time point is not clear, should we rather use
# values from Gerriet 2003 (Figure 4)?
sd_L = 50
b_0 = 50
b_1 = 0 # this values will be varied to simulate a causal treatment effect
b_2 = c(1.2) # this values were set according after combining estimates from Gerriet 2003 and O'Collins (Book Chapter):
# baseline stroke volume is 6h after MCAo, outcome measurement is 24h after MCAo
g_0 = 3
g_1 = c(-10) #this values will be varied to simulate a treatment effect on welfare with different magnitudes
g_2 = c(-5.5) #taken from Bederson et al. 1986
sd_Y = 25
sd_W = 2
cutoff_W = c(0.3)
n = 1000
report <- expand_grid(prob_A, mean_L, sd_L, b_0, b_1, b_2, g_0, g_1, g_2, sd_Y, sd_W, cutoff_W, n)
n_exp<-10000
dat<-data.frame()
coef_biased<-NA
baseline_adj_coef<-NA
estimate_biased<-NA
estimate_unbiased<-NA
set.seed(100)
exploratory_data <- list()
for(b in 1: n_exp) {
for ( i in 1:nrow(report)) {
dat <- data.frame(A = rep(0:1,report$prob_A[i]*report$n[i], each=1),
L = rnorm(n=report$n[i], mean=report$mean_L[i], sd=report$sd_L[i]))
dat$W <- report$g_0[i] + report$g_1[i]*dat$A + report$g_2[i]*dat$L + rnorm(report$n[i], 0, report$sd_W[i])
dat$Y <- report$b_0[i] + report$b_1[i]*dat$A + report$b_2[i]*dat$L + rnorm(report$n[i], 0, report$sd_Y[i])
dat$W2 <- dat$W >= quantile(dat$W, probs=report$cutoff_W[i])
dat$A <- as.factor(dat$A)
dat_s <- dat %>% filter(W2==TRUE)
#estimate in the censored data-set
estimate_biased[i] <-  mean(dat_s$Y[dat_s$A==1]) - mean(dat_s$Y[dat_s$A==0])
estimate_unbiased[i]<- mean(dat$Y[dat$A ==1]- mean(dat$Y[dat$A == 0]))
#perform a linear regression in the censored dataset
#without correcting for baselin stroke volume
model1<-lm(dat_s$Y ~ dat_s$A, data = dat_s)
coef_biased[i]<-model1$coefficients[2]
#while correcting for baseline stroke volume (dat$L)
model2<-lm(dat_s$Y ~ dat_s$A + dat_s$L, data = dat_s)
baseline_adj_coef[i] <-model2$coefficients[2]
report$coef_biased[i] <-coef_biased[i]
report$baseline_adj_coef[i]<-baseline_adj_coef[i]
report$estimate_biased[i] <-estimate_biased[i]
report$estimate_unbiased[i]<-estimate_unbiased[i]
}
exploratory_data[[b]]<-report
}
coef_biased<-list()
for (i in 1:length(exploratory_data)) {
coef_biased[[i]]<-exploratory_data[[i]]$coef_biased[1]}
vec_coef_biased<-as.vector(unlist(coef_biased))
baseline_adj_coef<-list()
for (i in 1:length(exploratory_data)) {
baseline_adj_coef[[i]]<-exploratory_data[[i]]$baseline_adj_coef[1]}
vec_baseline_adj_coef<-as.vector(unlist(baseline_adj_coef))
estimate_biased<-list()
for (i in 1:length(exploratory_data)) {
estimate_biased[[i]]<-exploratory_data[[i]]$estimate_biased[1]}
vec_estimate_biased<-as.vector(unlist(estimate_biased))
estimate_unbiased<-list()
for (i in 1:length(exploratory_data)) {
estimate_unbiased[[i]]<-exploratory_data[[i]]$estimate_unbiased[1]}
vec_estimate_unbiased<-as.vector(unlist(estimate_unbiased))
estimates<-data.frame(baseline_adj_coef = vec_baseline_adj_coef,
coef_biased = vec_coef_biased,
estimate_biased = vec_estimate_biased,
estimate_unbiased = vec_estimate_unbiased)
summary_estimates<-data.frame(diff_adj_unbiased = estimates$estimate_unbiased - estimates$baseline_adj_coef,
diff_unadj_unbiased = estimates$estimate_unbiased - estimates$coef_biased)
mean_estimates<-data.frame(mean_diff_adj_unbiased = mean(summary_estimates$diff_adj_unbiased),
mean_diff_unadj_unbiased = mean(summary_estimates$diff_unadj_unbiased))
View(mean_estimates)
hist(estimates$coef_biased)
hist(estimates$baseline_adj_coef)
summary(estimates$coef_biased)
summary(baseline_adj_coef)
summary(estimates$baseline_adj_coef)
summary_bac<-tidy(summary(estimates$baseline_adj_coef))
library(tidyverse)
library(ggplot2)
summary_bac<-tidy(summary(estimates$baseline_adj_coef))
tidy()
?broom()
summary_bac<-broom(summary(estimates$baseline_adj_coef))
library(broom)
summary_bac<-broom(summary(estimates$baseline_adj_coef))
install.packages("broom")
install.packages("broom")
summary_bac<-broom(summary(estimates$baseline_adj_coef))
summary_bac<-summary(estimates$baseline_adj_coef)
table(summary_bac)
summary_measures<-rbind(table(summary(estimates$coef_biased)),table(summary(estimates$baseline_adj_coef)), table(summmary(estimates$estimate_unbiased)))
summary(estimates$coef_biased)
summary_measures<-rbind(table(summary(estimates$coef_biased)),table(summary(estimates$baseline_adj_coef)), table(summary(estimates$estimate_unbiased)))
View(summary_measures)
summary(estimates$coef_biased)
summary_measures<-rbind(summary(estimates$coef_biased),summary(estimates$baseline_adj_coef), summary(estimates$estimate_unbiased))
View(summary_measures)
?rownames()
library(kableExtra)
install.packages(kableExtra)
